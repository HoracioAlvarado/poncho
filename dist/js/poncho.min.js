function ponchoChart(e){"use strict";var o=[],a=[],r=[],i="",t=[],n=[],s=[],c=[],l=[],d=0,p="",b=e.urlJson?e.urlJson:"https://sheets.googleapis.com/v4/spreadsheets/"+e.idSpread+"/values/"+e.hojaNombre+"?alt=json&key=AIzaSyCq2wEEKL9-6RmX-TkW23qJsrmnFHFf5tY",u=e.posicionLeyendas?e.posicionLeyendas:"top",f=function(e){var o="";"Line"==e&&(o="line");"Bar"==e&&(o="bar");"Pie"==e&&(o="pie");"Area"==e&&(o="line");"Horizontal Bar"==e&&(o="horizontalBar");"Stacked Bar"==e&&(o="bar");return o}(e.tipoGrafico);function g(e){var o="";switch(e){case"celeste":o="#2897d4";break;case"verde":o="#2e7d33";break;case"rojo":o="#c62828";break;case"amarillo":o="#f9a822";break;case"azul":o="#0072bb";break;case"negro":o="#333";break;case"uva":o="#6a1b99";break;case"gris":o="#525252";break;case"grisintermedio":o="#f2f2f2";break;case"celesteargentina":o="#37bbed";break;case"fucsia":o="#ec407a";break;case"arandano":o="#c2185b";break;case"uva":o="#6a1b99";break;case"cielo":o="#039be5";break;case"verdin":o="#6ea100";break;case"lima":o="#cddc39";break;case"maíz":o="#ffce00";break;case"tomate":o="#ef5350";break;case"naranjaoscuro":o="#EF6C00";break;case"verdeazulado":o="#008388";break;case"escarapela":o="#2cb9ee";break;case"lavanda":o="#9284be";break;case"mandarina":o="#f79525";break;case"palta":o="#50b7b2";break;case"cereza":o="#ed3d8f";break;case"limon":case"verdejade":case"verdealoe":case"verdecemento":o="#d7df23";break;default:console.log("No existe color "+e)}return o}!function(){var o=!1;void 0!==e.idSpread&&""!=e.idSpread&&void 0!==e.hojaNombre&&""!=e.hojaNombre&&void 0!==e.tipoGrafico&&""!=e.tipoGrafico&&void 0!==e.idComponenteGrafico&&""!=e.idComponenteGrafico&&""!=f&&(o=!0);return o}()?(void 0!==e.idSpread&&""!=e.idSpread||console.log("Completar valor para la opción de Configuración idSpread"),void 0!==e.hojaNombre&&""!=e.hojaNombre||console.log("Completar valor para la opción de Configuración hojaNombre"),void 0!==e.tipoGrafico&&""!=e.tipoGrafico||console.log("Completar valor para la opción de Configuración tipoGrafico"),void 0!==e.idComponenteGrafico&&""!=e.idComponenteGrafico||console.log("Completar valor para la opción de Configuración idComponenteGrafico"),""==f&&console.log("Ingrese un tipo de gafico válido")):jQuery.getJSON(b,function(b){var h,v,k=b.values;if(jQuery.each(Object.keys(k[0]),function(e,o){if("eje-y"==k[0][e].substr(0,5)){var i=k[0][e].split("-"),t=i[0]+i[1];a.push(t),r.push(e)}}),jQuery.each(k,function(e,a){if(0==e&&jQuery.each(r,function(o,a){var i=k[e][r[o]].split("-"),n=i[0]+i[1];c[n]=[],t.push(i[2])}),1==e&&jQuery.each(r,function(a,i){"pie"!=f?(s.push(k[e][r[a]]),d+=1):o.push(k[e][r[a]])}),e>1){var i=!1;jQuery.each(r,function(a,t){var n=k[0][r[a]].split("-"),s=n[0]+n[1];"pie"==f?c[s].push(k[e][r[a]]):(0==i&&(o.push(k[e][0]),i=!0),c[s].push(k[e][r[a]]))})}}),"pie"==f){var m=[];jQuery.each(Object.keys(a),function(e,o){var r=a[e];c.hasOwnProperty(r)&&m.push(c[r])}),l=m}else 1==d&&jQuery.each(Object.keys(a),function(e,o){var r=a[e];c.hasOwnProperty(r)&&(l=c[r])});if(p=1==e.porcentajes?{enabled:!0,callbacks:{label:function(e,o){return o.labels[e.index]+" ("+o.datasets[e.datasetIndex].data[e.index]+"%)"}}}:{enabled:!0},"pie"==f&&(t.forEach(function(e,o,a){n.push(g(e))}),console.log("etiquetas --\x3e "+o),console.log("datos --\x3e "+l),console.log("colores --\x3e "+n),function(e,o,a,r,i,t,n){const s=document.getElementById(i);new Chart(s,{type:a,data:{labels:e,datasets:[{data:o,borderColor:r,backgroundColor:r,borderWidth:2}]},options:{legend:{display:!0,position:t},responsive:!0,tooltips:n}})}(o,l,f,n,e.idComponenteGrafico,u,p)),1==d&&(console.log("etiquetas --\x3e "+o),console.log("datos --\x3e "+l),i=g(t[0]),console.log("color --\x3e "+i),"Line"==e.tipoGrafico&&function(e,o,a,r,i,t,n,s,c){const l=document.getElementById(n);new Chart(l,{type:a,data:{labels:e,datasets:[{data:o,borderColor:r,borderWidth:2,lineTension:0,fill:!1,label:i}]},options:{legend:{display:!0,position:s},tooltips:c,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:t}}]}}})}(o,l,f,i,s[0],e.ejeYenCero,e.idComponenteGrafico,u,p),"bar"!=f&&"Area"!=e.tipoGrafico&&"horizontalBar"!=f||function(e,o,a,r,i,t,n,s,c){const l=document.getElementById(n);new Chart(l,{type:a,data:{labels:e,datasets:[{data:o,borderColor:r,backgroundColor:r,borderWidth:2,lineTension:0,label:i}]},options:{legend:{display:!0,position:s},tooltips:c,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:t}}]}}})}(o,l,f,i,s[0],e.ejeYenCero,e.idComponenteGrafico,u,p)),d>1){var y=[],C=0;t.forEach(function(e,o,a){n.push(g(e))}),console.log("colores --\x3e "+n),jQuery.each(Object.keys(a),function(o,r){var i=a[o];if(c.hasOwnProperty(i)){if(l=c[i],console.log("datos --\x3e "+l),"Line"==e.tipoGrafico)var t={label:s[C],data:l,borderColor:n[C],fill:!1,borderWidth:2,lineTension:0};else if("Bar"==e.tipoGrafico||"Area"==e.tipoGrafico||"Horizontal Bar"==e.tipoGrafico||"Stacked Bar"==e.tipoGrafico)t={label:s[C],data:l,borderColor:n[C],backgroundColor:n[C],borderWidth:2,lineTension:0};y.push(t),C+=1}}),console.log("etiquetas --\x3e "+o),"Stacked Bar"==e.tipoGrafico?function(e,o,a,r,i,t,n){const s=document.getElementById(r);new Chart(s,{type:o,data:{labels:e,datasets:a},options:{legend:{display:!0,position:t,labels:{textAlign:"center"}},tooltips:n,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:i},stacked:!0}],xAxes:[{stacked:!0}]}}})}(o,f,y,e.idComponenteGrafico,e.ejeYenCero,u,p):function(e,o,a,r,i,t,n){const s=document.getElementById(r);new Chart(s,{type:o,data:{labels:e,datasets:a},options:{legend:{display:!0,position:t,labels:{textAlign:"center"}},tooltips:n,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:i}}]}}})}(o,f,y,e.idComponenteGrafico,e.ejeYenCero,u,p)}""!=e.tituloGrafico&&void 0!==e.tituloGrafico&&(h=e.idTagTituloGrafico,v=e.tituloGrafico,document.getElementById(h)&&(document.getElementById(h).innerHTML=v))})}
